jQuery(document).ready(function($){function a(a,e){$("#filter-date-range span").html(a.format("YYYY-MM-DD")+' <i class="fa fa-angle-right fa-fw"></i><br/> '+e.format("YYYY-MM-DD")),$("#filter-date-start").val(a.format("YYYY-MM-DD")),$("#filter-date-end").val(e.format("YYYY-MM-DD")),window.console.log($("#filter-date-start").val()+" - "+$("#filter-date-end").val()),d()}function e(a){void 0===a&&(a=0);var t=$("#panel-title-date"),r=$("#csi-template-ewa-mgmt-pagination"),n=$("#csi-template-ewa-mgmt-control-center-table tbody"),l=new FormData;l.append("action","csi_ajax_template_ewa_mgmt_control_center_fetch_alerts"),l.append("filter_start_date",$("#filter-date-start").val()),l.append("filter_end_date",$("#filter-date-end").val()),l.append("filter_customer",$("#filter-customer").val()),l.append("filter_sid",$("#filter-sid").val()),l.append("filter_ewa_rating",$("#filter-ewa-rating").val()),l.append("filter_alert_group",$("#filter-alert-group").val()),l.append("filter_alert_text",$("#filter-alert-text").val()),l.append("filter_alert_rating",$("#filter-alert-rating").val()),l.append("filter_action",$("#filter-action").val()),l.append("filter_customer_flag",$("#filter-customer-flag").val()),l.append("page_no",a),$.ajax({url:s,type:"POST",data:l,cache:!1,dataType:"json",processData:!1,contentType:!1,beforeSend:function(){n.addClass("ajax-loading"),r.addClass("ajax-loading")},success:function(a){(0!==a||void 0===a.error)&&(n.html(a.tbody),n.removeClass("ajax-loading"),r.removeClass("ajax-loading"),t.html(a.panelTitleDates),r.html(a.pagination),r.find("a").on("click",function(a){a.preventDefault(),e($(this).data("page-no"))}))},error:m})}function t(){var a=$("#csi-template-ewa-mgmt-control-center-infographics-alert"),e=$("#csi-template-ewa-mgmt-control-center-infographics-alert-chart"),t=new FormData;t.append("action","csi_ajax_template_ewa_mgmt_control_center_alert_chart"),t.append("filter_start_date",$("#filter-date-start").val()),t.append("filter_end_date",$("#filter-date-end").val()),t.append("filter_customer",$("#filter-customer").val()),t.append("filter_sid",$("#filter-sid").val()),t.append("filter_ewa_rating",$("#filter-ewa-rating").val()),t.append("filter_alert_group",$("#filter-alert-group").val()),t.append("filter_alert_text",$("#filter-alert-text").val()),t.append("filter_alert_rating",$("#filter-alert-rating").val()),t.append("filter_action",$("#filter-action").val()),t.append("filter_customer_flag",$("#filter-customer-flag").val()),a.on("shown.bs.collapse",function(){var a=AmCharts.charts,t=null;$.each(a,function(a,r){return e.attr("id")===r.div.id?(t=a,a):void 0}),null!==t&&a[t].invalidateSize()}),$.ajax({url:s,type:"POST",data:t,cache:!1,dataType:"json",processData:!1,contentType:!1,beforeSend:function(){e.addClass("ajax-loading")},success:function(a){if(void 0===a.error){var t=AmCharts.charts,r=null;$.each(t,function(a,t){return e.attr("id")===t.div.id?(r=a,a):void 0}),null===r?(AmCharts.makeChart(e.attr("id"),a.chart),e.removeClass("ajax-loading")):(t[r].graphs=a.graphs,t[r].dataProvider=a.dataProvider,t[r].validateData(),t[r].invalidateSize(),e.removeClass("ajax-loading"))}},error:m})}function r(){var a=$("#csi-template-ewa-mgmt-control-center-infographics-ewa-status"),e=$("#csi-template-ewa-mgmt-control-center-infographics-ewa-status-chart"),t=new FormData;t.append("action","csi_ajax_template_ewa_mgmt_control_center_ewa_status_chart"),t.append("filter_start_date",$("#filter-date-start").val()),t.append("filter_end_date",$("#filter-date-end").val()),t.append("filter_customer",$("#filter-customer").val()),t.append("filter_sid",$("#filter-sid").val()),t.append("filter_ewa_rating",$("#filter-ewa-rating").val()),t.append("filter_alert_group",$("#filter-alert-group").val()),t.append("filter_alert_text",$("#filter-alert-text").val()),t.append("filter_alert_rating",$("#filter-alert-rating").val()),t.append("filter_action",$("#filter-action").val()),t.append("filter_customer_flag",$("#filter-customer-flag").val()),a.on("shown.bs.collapse",function(){var a=AmCharts.charts,t=null;$.each(a,function(a,r){return e.attr("id")===r.div.id?(t=a,a):void 0}),null!==t&&a[t].invalidateSize()}),$.ajax({url:s,type:"POST",data:t,cache:!1,dataType:"json",processData:!1,contentType:!1,beforeSend:function(){e.addClass("ajax-loading")},success:function(a){if(void 0===a.error){var t=AmCharts.charts,r=null;$.each(t,function(a,t){return e.attr("id")===t.div.id?(r=a,a):void 0}),null===r?(AmCharts.makeChart(e.attr("id"),a.chart),e.removeClass("ajax-loading")):(t[r].graphs=a.graphs,t[r].dataProvider=a.dataProvider,t[r].validateData(),t[r].invalidateSize(),e.removeClass("ajax-loading"))}},error:m})}function n(){var a=$("#csi-template-ewa-mgmt-control-center-infographics-action-percentage-chart"),e=new FormData;e.append("action","csi_ajax_template_ewa_mgmt_control_center_action_gauge"),e.append("filter_start_date",$("#filter-date-start").val()),e.append("filter_end_date",$("#filter-date-end").val()),e.append("filter_customer",$("#filter-customer").val()),e.append("filter_sid",$("#filter-sid").val()),e.append("filter_ewa_rating",$("#filter-ewa-rating").val()),e.append("filter_alert_group",$("#filter-alert-group").val()),e.append("filter_alert_text",$("#filter-alert-text").val()),e.append("filter_alert_rating",$("#filter-alert-rating").val()),e.append("filter_action",$("#filter-action").val()),e.append("filter_customer_flag",$("#filter-customer-flag").val()),$.ajax({url:s,type:"POST",data:e,cache:!1,dataType:"json",processData:!1,contentType:!1,beforeSend:function(){a.addClass("ajax-loading")},success:function(e){if(void 0===e.error){a.html(e.chartsContainer);var t=$(e.charts);t.each(function(a,e){AmCharts.makeChart(e.divId,e)}),a.removeClass("ajax-loading")}},error:m})}function l(){var a=$("#csi-template-ewa-mgmt-control-center-infographics-alert-pies-chart"),e=new FormData;e.append("action","csi_ajax_template_ewa_mgmt_control_center_alert_pies"),e.append("filter_start_date",$("#filter-date-start").val()),e.append("filter_end_date",$("#filter-date-end").val()),e.append("filter_customer",$("#filter-customer").val()),e.append("filter_sid",$("#filter-sid").val()),e.append("filter_ewa_rating",$("#filter-ewa-rating").val()),e.append("filter_alert_group",$("#filter-alert-group").val()),e.append("filter_alert_text",$("#filter-alert-text").val()),e.append("filter_alert_rating",$("#filter-alert-rating").val()),e.append("filter_action",$("#filter-action").val()),e.append("filter_customer_flag",$("#filter-customer-flag").val()),$.ajax({url:s,type:"POST",data:e,cache:!1,dataType:"json",processData:!1,contentType:!1,beforeSend:function(){a.addClass("ajax-loading")},success:function(e){if(void 0===e.error){a.html(e.chartsContainer);var t=$(e.charts);t.each(function(a,e){AmCharts.makeChart(e.divId,e)}),a.removeClass("ajax-loading")}},error:m})}function i(){var a=$("#csi-template-ewa-mgmt-control-center-infographics-customer-ewas"),e=$("#csi-template-ewa-mgmt-control-center-infographics-customer-ewas-chart"),t=new FormData;t.append("action","csi_ajax_template_ewa_mgmt_control_center_customer_ewas"),t.append("filter_start_date",$("#filter-date-start").val()),t.append("filter_end_date",$("#filter-date-end").val()),t.append("filter_customer",$("#filter-customer").val()),t.append("filter_sid",$("#filter-sid").val()),t.append("filter_ewa_rating",$("#filter-ewa-rating").val()),t.append("filter_alert_group",$("#filter-alert-group").val()),t.append("filter_alert_text",$("#filter-alert-text").val()),t.append("filter_alert_rating",$("#filter-alert-rating").val()),t.append("filter_action",$("#filter-action").val()),t.append("filter_customer_flag",$("#filter-customer-flag").val()),a.on("shown.bs.collapse",function(){var a=AmCharts.charts,t=null;$.each(a,function(a,r){return e.attr("id")===r.div.id?(t=a,a):void 0}),null!==t&&a[t].invalidateSize()}),$.ajax({url:s,type:"POST",data:t,cache:!1,dataType:"json",processData:!1,contentType:!1,beforeSend:function(){e.addClass("ajax-loading")},success:function(a){if(void 0===a.error){var t=AmCharts.charts,r=null;$.each(t,function(a,t){return e.attr("id")===t.div.id?(r=a,a):void 0}),null===r?(AmCharts.makeChart(e.attr("id"),a.chart),e.removeClass("ajax-loading")):(t[r].graphs=a.graphs,t[r].dataProvider=a.dataProvider,t[r].validateData(),t[r].invalidateSize(),e.removeClass("ajax-loading"))}},error:m})}function o(){var a=$("#csi-template-ewa-mgmt-control-center-infographics-customer-alerts"),e=$("#csi-template-ewa-mgmt-control-center-infographics-customer-alerts-chart"),t=new FormData;t.append("action","csi_ajax_template_ewa_mgmt_control_center_customer_alerts"),t.append("filter_start_date",$("#filter-date-start").val()),t.append("filter_end_date",$("#filter-date-end").val()),t.append("filter_customer",$("#filter-customer").val()),t.append("filter_sid",$("#filter-sid").val()),t.append("filter_ewa_rating",$("#filter-ewa-rating").val()),t.append("filter_alert_group",$("#filter-alert-group").val()),t.append("filter_alert_text",$("#filter-alert-text").val()),t.append("filter_alert_rating",$("#filter-alert-rating").val()),t.append("filter_action",$("#filter-action").val()),t.append("filter_customer_flag",$("#filter-customer-flag").val()),a.on("shown.bs.collapse",function(){var a=AmCharts.charts,t=null;$.each(a,function(a,r){return e.attr("id")===r.div.id?(t=a,a):void 0}),null!==t&&a[t].invalidateSize()}),$.ajax({url:s,type:"POST",data:t,cache:!1,dataType:"json",processData:!1,contentType:!1,beforeSend:function(){e.addClass("ajax-loading")},success:function(a){if(void 0===a.error){var t=AmCharts.charts,r=null;$.each(t,function(a,t){return e.attr("id")===t.div.id?(r=a,a):void 0}),null===r?(AmCharts.makeChart(e.attr("id"),a.chart),e.removeClass("ajax-loading")):(t[r].graphs=a.graphs,t[r].dataProvider=a.dataProvider,t[r].validateData(),t[r].invalidateSize(),e.removeClass("ajax-loading"))}},error:m})}function d(){e(),t(),n(),r(),l(),i(),o()}var s=csiTemplateEwaMgmtControlCenter.ajaxurl,c={};document.location.search.replace(/\??(?:([^=]+)=([^&]*)&?)/g,function(){function a(a){return decodeURIComponent(a.split("+").join(" "))}c[a(arguments[1])]=a(arguments[2])});var f=moment().subtract(2,"month").startOf("month"),p=moment().endOf("week");if(void 0!==typeof c.date)switch(c.date){case"this-week":f=moment().startOf("week").add(1,"days"),p=moment().endOf("week").add(1,"days")}$("#filter-date-range").daterangepicker({showWeekNumbers:!0,startDate:f,endDate:p,drops:"up",locale:{format:"YYYY-MM-DD",firstDay:1},ranges:{"Semana actual":[moment().startOf("week").add(1,"days"),moment().endOf("week").add(1,"days")],"Semana anterior":[moment().subtract(1,"week").startOf("week").add(1,"days"),moment().subtract(1,"week").endOf("week").add(1,"days")],"Ultimos 30 Days":[moment().subtract(29,"days"),moment().endOf("week")],"Ultimos 2 meses":[moment().subtract(2,"month").startOf("month"),moment().endOf("week")],"Ultimos 4 meses":[moment().subtract(4,"month").startOf("month"),moment().endOf("week")],"Ultimos 6 meses":[moment().subtract(6,"month").startOf("month"),moment().endOf("week")]}},a),a(f,p);var m=function(a,e,t){var r="";r=0===a.status?"Not connect.\n Verify Network.":404===a.status?"Requested page not found. [404]":500===a.status?"Internal Server Error [500].":"parsererror"===e?"Requested JSON parse failed.":"timeout"===e?"Time out error.":"abort"===e?"Ajax request aborted.":"Uncaught Error.\n"+a.responseText,window.console.log("ERROR: "),window.console.log(a),window.console.log(e+" - "+t);var n="Este error de conexión con el servidor de fondo, regularmente indica que no has iniciado sesión en Wordpress.<br/>";window.console.log(s);var l=s.replace("admin-ajax.php","");n=n+"Intenta <strong><a href='"+l+"'>iniciar sesi&oacute;n</a></strong>. En caso que esto no funcione, por favor contacta al adminsitrador.",n=n+"<code>"+r+"</code>";var i="Error de conexión as&iacute;ncrona";$.alert({buttons:{heyThere:{text:"OK",btnClass:"btn-danger"}},closeIcon:!0,columnClass:"large",content:n,title:i,type:"red"})};$("form.table-filter-form").submit(function(a){a.preventDefault(),d()}),$("form.table-filter-form select").change(function(){d()})});