jQuery(document).ready(function($){function t(t,e){$("#filter-date-range span").html(t.format("YYYY-MM-DD")+' <i class="fa fa-angle-right fa-fw"></i><br/> '+e.format("YYYY-MM-DD")),$("#filter-date-start").val(t.format("YYYY-MM-DD")),$("#filter-date-end").val(e.format("YYYY-MM-DD")),window.console.log($("#filter-date-start").val()),window.console.log($("#filter-date-end").val()),o()}function e(){var t=$("#panel-title-date"),e=$("#csi-template-ewa-mgmt-control-center-table tbody"),a=new FormData;a.append("action","csi_ajax_template_ewa_mgmt_control_center_fetch_alerts"),a.append("filter_start_date",$("#filter-date-start").val()),a.append("filter_end_date",$("#filter-end-start").val()),a.append("filter_customer",$("#filter-customer").val()),a.append("filter_sid",$("#filter-sid").val()),a.append("filter_alert_group",$("#filter-alert-group").val()),a.append("filter_alert_text",$("#filter-alert-text").val()),a.append("filter_action",$("#filter-action").val()),a.append("filter_customer_flag",$("#filter-customer-flag").val()),$.ajax({url:l,type:"POST",data:a,cache:!1,dataType:"json",processData:!1,contentType:!1,beforeSend:function(){e.addClass("ajax-loading")},success:function(a){void 0===a.error&&(e.fadeOut(400,function(){e.html(a.tbody),e.fadeIn(400,function(){e.removeClass("ajax-loading")})}),t.html(a.panelTitleDates))},error:d})}function a(){var t=$("#csi-template-ewa-mgmt-control-center-infographics-alert"),e=$("#csi-template-ewa-mgmt-control-center-infographics-alert-chart"),a=new FormData;a.append("action","csi_ajax_template_ewa_mgmt_control_center_alert_chart"),a.append("filter_start_date",$("#filter-date-start").val()),a.append("filter_end_date",$("#filter-end-start").val()),a.append("filter_customer",$("#filter-customer").val()),a.append("filter_sid",$("#filter-sid").val()),a.append("filter_alert_group",$("#filter-alert-group").val()),a.append("filter_alert_text",$("#filter-alert-text").val()),a.append("filter_action",$("#filter-action").val()),a.append("filter_customer_flag",$("#filter-customer-flag").val()),t.on("shown.bs.collapse",function(){var t=AmCharts.charts,a=null;$.each(t,function(t,r){return e.attr("id")===r.div.id?(a=t,t):void 0}),null!==a&&t[a].invalidateSize()}),$.ajax({url:l,type:"POST",data:a,cache:!1,dataType:"json",processData:!1,contentType:!1,beforeSend:function(){e.addClass("ajax-loading")},success:function(t){if(void 0===t.error){var a=AmCharts.charts,r=null;$.each(a,function(t,a){return e.attr("id")===a.div.id?(r=t,t):void 0}),null===r?(AmCharts.makeChart(e.attr("id"),t.chart),e.removeClass("ajax-loading")):(a[r].graphs=t.graphs,a[r].dataProvider=t.dataProvider,a[r].validateData(),a[r].invalidateSize(),e.removeClass("ajax-loading"))}},error:d})}function r(){var t=$("#csi-template-ewa-mgmt-control-center-infographics-ewa-status"),e=$("#csi-template-ewa-mgmt-control-center-infographics-ewa-status-chart"),a=new FormData;a.append("action","csi_ajax_template_ewa_mgmt_control_center_ewa_status_chart"),a.append("filter_start_date",$("#filter-date-start").val()),a.append("filter_end_date",$("#filter-end-start").val()),a.append("filter_customer",$("#filter-customer").val()),a.append("filter_sid",$("#filter-sid").val()),a.append("filter_alert_group",$("#filter-alert-group").val()),a.append("filter_alert_text",$("#filter-alert-text").val()),a.append("filter_action",$("#filter-action").val()),a.append("filter_customer_flag",$("#filter-customer-flag").val()),t.on("shown.bs.collapse",function(){var t=AmCharts.charts,a=null;$.each(t,function(t,r){return e.attr("id")===r.div.id?(a=t,t):void 0}),null!==a&&t[a].invalidateSize()}),$.ajax({url:l,type:"POST",data:a,cache:!1,dataType:"json",processData:!1,contentType:!1,beforeSend:function(){e.addClass("ajax-loading")},success:function(t){if(void 0===t.error){var a=AmCharts.charts,r=null;$.each(a,function(t,a){return e.attr("id")===a.div.id?(r=t,t):void 0}),null===r?(AmCharts.makeChart(e.attr("id"),t.chart),e.removeClass("ajax-loading")):(a[r].graphs=t.graphs,a[r].dataProvider=t.dataProvider,a[r].validateData(),a[r].invalidateSize(),e.removeClass("ajax-loading"))}},error:d})}function n(){var t=$("#csi-template-ewa-mgmt-control-center-infographics-action-percentage-chart"),e=new FormData;e.append("action","csi_ajax_template_ewa_mgmt_control_center_action_gauge"),e.append("filter_start_date",$("#filter-date-start").val()),e.append("filter_end_date",$("#filter-end-start").val()),e.append("filter_customer",$("#filter-customer").val()),e.append("filter_sid",$("#filter-sid").val()),e.append("filter_alert_group",$("#filter-alert-group").val()),e.append("filter_alert_text",$("#filter-alert-text").val()),e.append("filter_action",$("#filter-action").val()),e.append("filter_customer_flag",$("#filter-customer-flag").val()),$.ajax({url:l,type:"POST",data:e,cache:!1,dataType:"json",processData:!1,contentType:!1,beforeSend:function(){t.addClass("ajax-loading")},success:function(e){if(void 0===e.error){t.html(e.chartsContainer);var a=$(e.charts);a.each(function(t,e){AmCharts.makeChart(e.divId,e)}),t.removeClass("ajax-loading")}},error:d})}function o(){e(),a(),n(),r()}var l=csiTemplateEwaMgmtControlCenter.ajaxurl,i=moment().subtract(2,"month").startOf("month"),s=moment();$("#filter-date-range").daterangepicker({startDate:i,endDate:s,ranges:{"Ultimos 30 Days":[moment().subtract(29,"days"),moment()],"Ultimos 2 meses":[moment().subtract(2,"month").startOf("month"),moment().endOf("month")],"Ultimos 4 meses":[moment().subtract(4,"month").startOf("month"),moment().endOf("month")],"Ultimos 6 meses":[moment().subtract(6,"month").startOf("month"),moment().endOf("month")]}},t),t(i,s);var d=function(t,e,a){var r="";r=0===t.status?"Not connect.\n Verify Network.":404===t.status?"Requested page not found. [404]":500===t.status?"Internal Server Error [500].":"parsererror"===e?"Requested JSON parse failed.":"timeout"===e?"Time out error.":"abort"===e?"Ajax request aborted.":"Uncaught Error.\n"+t.responseText,window.console.log("ERROR: "),window.console.log(t),window.console.log(e+" - "+a);var n="Este error de conexión con el servidor de fondo, regularmente indica que no has iniciado sesión en Wordpress.<br/>";window.console.log(l);var o=l.replace("admin-ajax.php","");n=n+"Intenta <strong><a href='"+o+"'>iniciar sesi&oacute;n</a></strong>. En caso que esto no funcione, por favor contacta al adminsitrador.",n=n+"<code>"+r+"</code>";var i="Error de conexión as&iacute;ncrona";$.alert({buttons:{heyThere:{text:"OK",btnClass:"btn-danger"}},closeIcon:!0,columnClass:"large",content:n,title:i,type:"red"})};$("form.table-filter-form").submit(function(t){t.preventDefault(),o()}),$("form.table-filter-form select").change(function(){o()})});