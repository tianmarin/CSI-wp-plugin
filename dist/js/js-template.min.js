jQuery(document).ready(function(a){function e(e,t){a("#filter-date-range span").html(e.format("YYYY-MM-DD")+' <i class="fa fa-angle-right fa-fw"></i><br/> '+t.format("YYYY-MM-DD")),a("#filter-date-start").val(e.format("YYYY-MM-DD")),a("#filter-date-end").val(t.format("YYYY-MM-DD")),window.console.log(a("#filter-date-start").val()+" - "+a("#filter-date-end").val()),s()}function t(e){void 0===e&&(e=0);var r=a("#panel-title-date"),n=a("#csi-template-ewa-mgmt-pagination"),l=a("#csi-template-ewa-mgmt-control-center-table tbody"),i=new FormData;i.append("action","csi_ajax_template_ewa_mgmt_control_center_fetch_alerts"),i.append("filter_start_date",a("#filter-date-start").val()),i.append("filter_end_date",a("#filter-date-end").val()),i.append("filter_customer",a("#filter-customer").val()),i.append("filter_sid",a("#filter-sid").val()),i.append("filter_ewa_rating",a("#filter-ewa-rating").val()),i.append("filter_alert_group",a("#filter-alert-group").val()),i.append("filter_alert_text",a("#filter-alert-text").val()),i.append("filter_alert_rating",a("#filter-alert-rating").val()),i.append("filter_action",a("#filter-action").val()),i.append("filter_customer_flag",a("#filter-customer-flag").val()),i.append("page_no",e),a.ajax({url:c,type:"POST",data:i,cache:!1,dataType:"json",processData:!1,contentType:!1,beforeSend:function(){l.addClass("ajax-loading"),n.addClass("ajax-loading")},success:function(e){0===e&&void 0!==e.error||(l.html(e.tbody),l.removeClass("ajax-loading"),n.removeClass("ajax-loading"),r.html(e.panelTitleDates),n.html(e.pagination),n.find("a").on("click",function(e){e.preventDefault(),t(a(this).data("page-no"))}))},error:_})}function r(){var e=a("#csi-template-ewa-mgmt-control-center-infographics-alert"),t=a("#csi-template-ewa-mgmt-control-center-infographics-alert-chart"),r=new FormData;r.append("action","csi_ajax_template_ewa_mgmt_control_center_alert_chart"),r.append("filter_start_date",a("#filter-date-start").val()),r.append("filter_end_date",a("#filter-date-end").val()),r.append("filter_customer",a("#filter-customer").val()),r.append("filter_sid",a("#filter-sid").val()),r.append("filter_ewa_rating",a("#filter-ewa-rating").val()),r.append("filter_alert_group",a("#filter-alert-group").val()),r.append("filter_alert_text",a("#filter-alert-text").val()),r.append("filter_alert_rating",a("#filter-alert-rating").val()),r.append("filter_action",a("#filter-action").val()),r.append("filter_customer_flag",a("#filter-customer-flag").val()),e.on("shown.bs.collapse",function(){var e=AmCharts.charts,r=null;a.each(e,function(a,e){if(t.attr("id")===e.div.id)return r=a,a}),null!==r&&e[r].invalidateSize()}),a.ajax({url:c,type:"POST",data:r,cache:!1,dataType:"json",processData:!1,contentType:!1,beforeSend:function(){t.addClass("ajax-loading")},success:function(e){if(void 0===e.error){var r=AmCharts.charts,n=null;a.each(r,function(a,e){if(t.attr("id")===e.div.id)return n=a,a}),null===n?(AmCharts.makeChart(t.attr("id"),e.chart),t.removeClass("ajax-loading")):(r[n].graphs=e.graphs,r[n].dataProvider=e.dataProvider,r[n].validateData(),r[n].invalidateSize(),t.removeClass("ajax-loading"))}},error:_})}function n(){var e=a("#csi-template-ewa-mgmt-control-center-infographics-ewa-status"),t=a("#csi-template-ewa-mgmt-control-center-infographics-ewa-status-chart"),r=new FormData;r.append("action","csi_ajax_template_ewa_mgmt_control_center_ewa_status_chart"),r.append("filter_start_date",a("#filter-date-start").val()),r.append("filter_end_date",a("#filter-date-end").val()),r.append("filter_customer",a("#filter-customer").val()),r.append("filter_sid",a("#filter-sid").val()),r.append("filter_ewa_rating",a("#filter-ewa-rating").val()),r.append("filter_alert_group",a("#filter-alert-group").val()),r.append("filter_alert_text",a("#filter-alert-text").val()),r.append("filter_alert_rating",a("#filter-alert-rating").val()),r.append("filter_action",a("#filter-action").val()),r.append("filter_customer_flag",a("#filter-customer-flag").val()),e.on("shown.bs.collapse",function(){var e=AmCharts.charts,r=null;a.each(e,function(a,e){if(t.attr("id")===e.div.id)return r=a,a}),null!==r&&e[r].invalidateSize()}),a.ajax({url:c,type:"POST",data:r,cache:!1,dataType:"json",processData:!1,contentType:!1,beforeSend:function(){t.addClass("ajax-loading")},success:function(e){if(void 0===e.error){var r=AmCharts.charts,n=null;a.each(r,function(a,e){if(t.attr("id")===e.div.id)return n=a,a}),null===n?(AmCharts.makeChart(t.attr("id"),e.chart),t.removeClass("ajax-loading")):(r[n].graphs=e.graphs,r[n].dataProvider=e.dataProvider,r[n].validateData(),r[n].invalidateSize(),t.removeClass("ajax-loading"))}},error:_})}function l(){var e=a("#csi-template-ewa-mgmt-control-center-infographics-action-percentage-chart"),t=new FormData;t.append("action","csi_ajax_template_ewa_mgmt_control_center_action_gauge"),t.append("filter_start_date",a("#filter-date-start").val()),t.append("filter_end_date",a("#filter-date-end").val()),t.append("filter_customer",a("#filter-customer").val()),t.append("filter_sid",a("#filter-sid").val()),t.append("filter_ewa_rating",a("#filter-ewa-rating").val()),t.append("filter_alert_group",a("#filter-alert-group").val()),t.append("filter_alert_text",a("#filter-alert-text").val()),t.append("filter_alert_rating",a("#filter-alert-rating").val()),t.append("filter_action",a("#filter-action").val()),t.append("filter_customer_flag",a("#filter-customer-flag").val()),a.ajax({url:c,type:"POST",data:t,cache:!1,dataType:"json",processData:!1,contentType:!1,beforeSend:function(){e.addClass("ajax-loading")},success:function(t){if(void 0===t.error){e.html(t.chartsContainer);var r=a(t.charts);r.each(function(a,e){AmCharts.makeChart(e.divId,e)}),e.removeClass("ajax-loading")}},error:_})}function i(){var e=a("#csi-template-ewa-mgmt-control-center-infographics-alert-pies-chart"),t=new FormData;t.append("action","csi_ajax_template_ewa_mgmt_control_center_alert_pies"),t.append("filter_start_date",a("#filter-date-start").val()),t.append("filter_end_date",a("#filter-date-end").val()),t.append("filter_customer",a("#filter-customer").val()),t.append("filter_sid",a("#filter-sid").val()),t.append("filter_ewa_rating",a("#filter-ewa-rating").val()),t.append("filter_alert_group",a("#filter-alert-group").val()),t.append("filter_alert_text",a("#filter-alert-text").val()),t.append("filter_alert_rating",a("#filter-alert-rating").val()),t.append("filter_action",a("#filter-action").val()),t.append("filter_customer_flag",a("#filter-customer-flag").val()),a.ajax({url:c,type:"POST",data:t,cache:!1,dataType:"json",processData:!1,contentType:!1,beforeSend:function(){e.addClass("ajax-loading")},success:function(t){if(void 0===t.error){e.html(t.chartsContainer);var r=a(t.charts);r.each(function(a,e){AmCharts.makeChart(e.divId,e)}),e.removeClass("ajax-loading")}},error:_})}function o(){var e=a("#csi-template-ewa-mgmt-control-center-infographics-customer-ewas"),t=a("#csi-template-ewa-mgmt-control-center-infographics-customer-ewas-chart"),r=new FormData;r.append("action","csi_ajax_template_ewa_mgmt_control_center_customer_ewas"),r.append("filter_start_date",a("#filter-date-start").val()),r.append("filter_end_date",a("#filter-date-end").val()),r.append("filter_customer",a("#filter-customer").val()),r.append("filter_sid",a("#filter-sid").val()),r.append("filter_ewa_rating",a("#filter-ewa-rating").val()),r.append("filter_alert_group",a("#filter-alert-group").val()),r.append("filter_alert_text",a("#filter-alert-text").val()),r.append("filter_alert_rating",a("#filter-alert-rating").val()),r.append("filter_action",a("#filter-action").val()),r.append("filter_customer_flag",a("#filter-customer-flag").val()),e.on("shown.bs.collapse",function(){var e=AmCharts.charts,r=null;a.each(e,function(a,e){if(t.attr("id")===e.div.id)return r=a,a}),null!==r&&e[r].invalidateSize()}),a.ajax({url:c,type:"POST",data:r,cache:!1,dataType:"json",processData:!1,contentType:!1,beforeSend:function(){t.addClass("ajax-loading")},success:function(e){if(void 0===e.error){var r=AmCharts.charts,n=null;a.each(r,function(a,e){if(t.attr("id")===e.div.id)return n=a,a}),null===n?(AmCharts.makeChart(t.attr("id"),e.chart),t.removeClass("ajax-loading")):(r[n].graphs=e.graphs,r[n].dataProvider=e.dataProvider,r[n].validateData(),r[n].invalidateSize(),t.removeClass("ajax-loading"))}},error:_})}function d(){var e=a("#csi-template-ewa-mgmt-control-center-infographics-customer-alerts"),t=a("#csi-template-ewa-mgmt-control-center-infographics-customer-alerts-chart"),r=new FormData;r.append("action","csi_ajax_template_ewa_mgmt_control_center_customer_alerts"),r.append("filter_start_date",a("#filter-date-start").val()),r.append("filter_end_date",a("#filter-date-end").val()),r.append("filter_customer",a("#filter-customer").val()),r.append("filter_sid",a("#filter-sid").val()),r.append("filter_ewa_rating",a("#filter-ewa-rating").val()),r.append("filter_alert_group",a("#filter-alert-group").val()),r.append("filter_alert_text",a("#filter-alert-text").val()),r.append("filter_alert_rating",a("#filter-alert-rating").val()),r.append("filter_action",a("#filter-action").val()),r.append("filter_customer_flag",a("#filter-customer-flag").val()),e.on("shown.bs.collapse",function(){var e=AmCharts.charts,r=null;a.each(e,function(a,e){if(t.attr("id")===e.div.id)return r=a,a}),null!==r&&e[r].invalidateSize()}),a.ajax({url:c,type:"POST",data:r,cache:!1,dataType:"json",processData:!1,contentType:!1,beforeSend:function(){t.addClass("ajax-loading")},success:function(e){if(void 0===e.error){var r=AmCharts.charts,n=null;a.each(r,function(a,e){if(t.attr("id")===e.div.id)return n=a,a}),null===n?(AmCharts.makeChart(t.attr("id"),e.chart),t.removeClass("ajax-loading")):(r[n].graphs=e.graphs,r[n].dataProvider=e.dataProvider,r[n].validateData(),r[n].invalidateSize(),t.removeClass("ajax-loading"))}},error:_})}function s(){t(),r(),l(),n(),i(),o(),d()}var c=csiTemplateEwaMgmtControlCenter.ajaxurl,f={};document.location.search.replace(/\??(?:([^=]+)=([^&]*)&?)/g,function(){function a(a){return decodeURIComponent(a.split("+").join(" "))}f[a(arguments[1])]=a(arguments[2])});var p=moment().subtract(2,"month").startOf("month"),m=moment().endOf("week");if(void 0!==typeof f.date)switch(f.date){case"this-week":p=moment().startOf("week").add(1,"days"),m=moment().endOf("week").add(1,"days")}a("#filter-date-range").daterangepicker({showWeekNumbers:!0,startDate:p,endDate:m,drops:"up",locale:{format:"YYYY-MM-DD",firstDay:1},ranges:{"Semana actual":[moment().startOf("week").add(1,"days"),moment().endOf("week").add(1,"days")],"Semana anterior":[moment().subtract(1,"week").startOf("week").add(1,"days"),moment().subtract(1,"week").endOf("week").add(1,"days")],"Ultimos 30 Days":[moment().subtract(29,"days"),moment().endOf("week")],"Ultimos 2 meses":[moment().subtract(2,"month").startOf("month"),moment().endOf("week")],"Ultimos 4 meses":[moment().subtract(4,"month").startOf("month"),moment().endOf("week")],"Ultimos 6 meses":[moment().subtract(6,"month").startOf("month"),moment().endOf("week")]}},e),e(p,m);var _=function(e,t,r){var n="";n=0===e.status?"Not connect.\n Verify Network.":404===e.status?"Requested page not found. [404]":500===e.status?"Internal Server Error [500].":"parsererror"===t?"Requested JSON parse failed.":"timeout"===t?"Time out error.":"abort"===t?"Ajax request aborted.":"Uncaught Error.\n"+e.responseText,window.console.log("ERROR: "),window.console.log(e),window.console.log(t+" - "+r);var l="Este error de conexión con el servidor de fondo, regularmente indica que no has iniciado sesión en Wordpress.<br/>";window.console.log(c);var i=c.replace("admin-ajax.php","");l=l+"Intenta <strong><a href='"+i+"'>iniciar sesi&oacute;n</a></strong>. En caso que esto no funcione, por favor contacta al adminsitrador.",l=l+"<code>"+n+"</code>";var o="Error de conexión as&iacute;ncrona";a.alert({buttons:{heyThere:{text:"OK",btnClass:"btn-danger"}},closeIcon:!0,columnClass:"large",content:l,title:o,type:"red"})};a("form.table-filter-form").submit(function(a){a.preventDefault(),s()}),a("form.table-filter-form select").change(function(){s()})});