{"version":3,"sources":["basic.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"csi-template-js.min.js","sourcesContent":["/*\nScript Name: Shortcode EWA Control Center\nDependencies: jquery, bootstrap, amcharts, amcharts-serial, amcharts-responsive, amcharts-pie\n*/\n/*global document*/\n/*global csiTemplateScript*/\n/*global FormData*/\n/*global jconfirm*/\njQuery(document).ready(function($){\n/*\n* Global Variables\n*/\nvar cmpMainContent = $('#csi-template-cmp-control-center-main');\nvar ajaxPages={\n    'intro'     :   'csi_cmp_build_page_intro',\n\t'listplans'\t:\t'csi_cmp_build_page_list_plans',\n\t'addplan'\t:\t'csi_cmp_build_page_new_plan_form',\n    'showplan'  :   'csi_cmp_build_page_show_plan',\n    'addtask'   :   'csi_cmp_build_page_new_task_form',\n};\n\nvar changeHash = function ( nextPage ) {\n\tif ( undefined !== nextPage &&  '' !== nextPage ){\n\t\twindow.location.hash='#!' + nextPage;\n\t}\n\treturn true;\n};\n\n\n$(document).on({\n\tajaxStart\t: function() {\n\t\t$('#csi-template-cmp-control-center-ajax').fadeIn();\n\t},\n\tajaxStop\t: function() {\n\t\tsetTimeout(function(){\n\t\t\t$('#csi-template-cmp-control-center-ajax').fadeOut();\n\t\t}, 1000);\n\t}\n});\nvar aaAjaxError = function(jqXHR, textStatus, errorThrown){\n\tvar msg = '';\n\tif (jqXHR.status === 0) {\n\t\tmsg = 'Not connect.\\n Verify Network.';\n\t} else if (jqXHR.status === 404) {\n\t\tmsg = 'Requested page not found. [404]';\n\t} else if (jqXHR.status === 500) {\n\t\tmsg = 'Internal Server Error [500].';\n\t} else if (textStatus === 'parsererror') {\n\t\tmsg = 'Requested JSON parse failed.';\n\t} else if (textStatus === 'timeout') {\n\t\tmsg = 'Time out error.';\n\t} else if (textStatus === 'abort') {\n\t\tmsg = 'Ajax request aborted.';\n\t} else {\n\t\tmsg = 'Uncaught Error.\\n' + jqXHR.responseText;\n\t}\n\twindow.console.log('ERROR: ');\n\twindow.console.log(jqXHR);\n\twindow.console.log(textStatus+' - '+errorThrown);\n\tvar text='Este error de conexión con el servidor de fondo, regularmente indica que no has iniciado sesión en Wordpress.<br/>';\n\twindow.console.log(csiTemplateScript.ajaxUrl);\n\tvar url = csiTemplateScript.ajaxUrl.replace('admin-ajax.php', '');\n\ttext=text+'Intenta <strong><a href=\"' + url + '\">iniciar sesi&oacute;n</a></strong>. En caso que esto no funcione, por favor contacta al adminsitrador.';\n\ttext=text+'<code>' + msg + '</code>';\n\tvar title = 'Error de conexión as&iacute;ncrona';\n\t$.alert({\n\t\tbuttons:{\n\t\t\tOK: {\n\t\t\t\ttext: 'OK',\n\t\t\t\tbtnClass: 'btn-danger',\n\t\t\t},\n\t\t},\n\t\tcloseIcon: true,\n\t\tcolumnClass: 'large',\n\t\tcontent:text,\n\t\ttitle: title,\n\t\ttype:'red',\n\t});\n};\n\n//llamada Ajax para cargar contenido.\n\t//si sale bien\n\t\t//si hay error\n\t\t//sino\n\t\t\t//apagar lo actual\n\t//si sale mal\n\t\t//$.alert\n\t\t//guardar log (sm21)\n$(window).bind( 'hashchange', function(event) {\n    event.preventDefault();\n    //eval hash in the url\n    var hash = '';\n    var hashRegEx = /\\#\\!(\\w+)/;\n    if ( hashRegEx.test(window.location.hash) ){\n        hash = window.location.hash.match(hashRegEx)[1];\n    }else{\n        return false;\n    }\n    //eval GET Variables in the URL\n    var getRegEx = /(\\w+=\\w+)+/g;\n    var GET=[];\n    if ( getRegEx.test(window.location.hash) ){\n        $.each( window.location.hash.match( getRegEx ), function ( key, val ) {\n            var parameter = val.split('=');\n            GET[parameter[0]] = parameter[1];\n        });\n    }else{\n        GET = null;\n    }\n    //eval softGET Variables in the URL\n    var sGetRegEx = /\\/(\\w+)/g;\n    var sGET=[];\n    if ( sGetRegEx.test(window.location.hash) ){\n        sGET = window.location.hash.match( sGetRegEx );\n    }else{\n        sGET = null;\n    }\n\n\tswitch ( hash ){\n\t\tcase '':\n\t\t\t$.alert({\n\t\t\t\tcloseIcon: true,\n\t\t\t\tcolumnClass: 'large',\n\t\t\t\tcontent:'He ocurrido un error al llamar al enlace.',\n\t\t\t\ttitle: 'Acceso incorrecto',\n\t\t\t\ttype:'red',\n\t\t\t});\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tloadPageContent(hash, GET, sGET);\n\t}\n    return true;\n});\nif( window.location.hash === '' ){\n\twindow.location.hash='#!intro';\n\t$(window).trigger( 'hashchange' ); // user refreshed the browser, fire the appropriate function\n}else{\n\t$(window).trigger( 'hashchange' ); // user refreshed the browser, fire the appropriate function\n}\n\nfunction loadPageContent ( hash, get ) {\n    var GET = get;\n\tvar data = new FormData();\n//    console.log ( 'Llamando a pagina : ' + ajaxPages[hash] + '(' + hash + ')');\n\tdata.append ( 'action', ajaxPages[hash] );\n    if ( null !== GET ){\n        for ( var item in GET){\n            data.append ( item, GET[item] );\n        }\n    }\n\t$.ajax({\n\t\turl: csiTemplateScript.ajaxUrl,\n\t\ttype: 'POST',\n\t\tdata: data,\n\t\tcache: false,\n\t\tdataType: 'json',\n\t\tprocessData: false,\n\t\tcontentType: false,\n\t\tbeforeSend: function () {\n\t\t},\n\t\tsuccess: function(response){\n            //console.log(response);\n\t\t\tvar animationEnd = 'webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend';\n\t\t\tcmpMainContent.addClass('quick-animated ' + 'fadeOutDown').one(animationEnd, function() {\n\t\t\t\t$('html, body').animate({ scrollTop: 0 }, 'slow');\n\t\t\t\t$(this).removeClass('quick-animated ' + 'fadeOutDown');\n\t\t\t\t$(this).html(response.message);\n\t\t\t\tcsiRefreshEventListener();\n\t\t\t\tcmpMainContent.addClass('quick-animated ' + 'fadeInUp').one(animationEnd, function() {\n\t\t\t\t\t$(this).removeClass('quick-animated ' + 'fadeInUp');\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\terror: aaAjaxError,\n\t});\n}\nfunction csiTemplateCmpFetchTableContent( tableSelector ){\n    var table = tableSelector;\n    var data = new FormData();\n    $.each(table.data(),function(index,val){\n        data.append(index,val);\n    });\n    $.ajax({\n        url: csiTemplateScript.ajaxUrl,\n        type: 'POST',\n        data: data,\n        cache: false,\n        dataType: 'json',\n        processData: false,\n        contentType: false,\n        beforeSend: function () {\n            table.addClass('ajax-loading');\n        },\n        success: function(response){\n            setTimeout(function(){\n    \t\t\ttable.removeClass('ajax-loading');\n    \t\t}, 500);\n        //    console.log ( response );\n            if ( 0 === response ){\n                //console.log ( table.data('refresh-action') );\n            }else{\n                if ( 'TABLE' === table.prop(\"tagName\") ){\n                    table.find('tbody').html(response.tbody);\n                }else{\n                    table.html('');\n                    table.append(response.tbody);\n                }\n            }\n        },\n        error: aaAjaxError,\n    });\n}\n\nfunction csiTemplateCmpFetchUserData ( userId ){\n    var user = userId;\n    var data = new FormData();\n    //filters related to this table\n    data.append('action', 'csi_cmp_fetch_user_data' );\n    data.append('user-id', user );\n    $.ajax({\n        url: csiTemplateScript.ajaxUrl,\n        type: 'POST',\n        data: data,\n        cache: false,\n        dataType: 'json',\n        processData: false,\n        contentType: false,\n        beforeSend: function () {},\n        success: function(response){\n            if ( 0 === response ){\n                console.log ( 'what?' );\n            }else{\n                if ( undefined !== response.notification ) {\n                    jconfirm ( response.notification );\n                }\n            }\n        },\n        error: aaAjaxError,\n    });\n}\n\nfunction csiRefreshEventListener(){\n\t$('[type=\"reset\"]').click(function(event){\n\t\tevent.preventDefault();\n\t\twindow.history.back();\n\t});\n\n    $.each ( $('.refreshable'), function(){\n        csiTemplateCmpFetchTableContent ( $(this) );\n    });\n    $('.refresh-button').click( function(event){\n        event.preventDefault();\n        csiTemplateCmpFetchTableContent ( $('#' + $(this).attr('href').replace( '#', '') ) );\n        //console.log( e );\n    });\n    $('.user-data').click( function(event){\n        event.preventDefault();\n        csiTemplateCmpFetchUserData( $(this).data('user-id') );\n    });\n\t$('.select2').select2({\n\t\ttokenSeparators: [',', ' '],\n\t});\n\t$('form').submit(function(){\n\t\tvar form = $(this);\n\t\tconsole.log ( $(this).data('next-page') );\n\t\tvar data = new FormData();\n\t\tdata.append('action', form.data('function'));\n\t\t$(this).find('input, select, textarea, checkbox').each(function(){\n\t\t\tdata.append($(this).attr('name'),$(this).val());\n\t\t});\n\t\t$.ajax({\n\t\t\turl: csiTemplateScript.ajaxUrl,\n\t\t\ttype: 'POST',\n\t\t\tdata: data,\n\t\t\tcache: false,\n\t\t\tdataType: 'json',\n\t\t\tprocessData: false,\n\t\t\tcontentType: false,\n\t\t\tbeforeSend: function () {\n\t\t\t\tform.addClass('ajax-loading');\n\t\t\t},\n\t\t\tsuccess: function(response){\n\t\t\t\tform.removeClass('ajax-loading');\n\t\t\t\tconsole.log ( response );\n\t\t\t\tif ( 0 === response ){\n\t\t\t\t\taaAjaxError();\n\t\t\t\t}else{\n                    if ( undefined !== response.error){\n                        //error al crear plan\n    \t\t\t\t}else{\n                        //plan creado correctamente\n                    }\n\n                    if ( undefined !== response.notification ) {\n                        switch ( response.postSubmitAction ){\n                            case 'changeHash':\n                                if ( undefined === response.notifStopNextPage ){\n                                    //http://stackoverflow.com/a/34567019/5129222\n                                    response.notification.onClose = changeHash.bind(null,form.data('next-page') );\n                                }\n                                break;\n                                default:\n                                    response.notification.onClose = function(){};\n                        }\n                        jconfirm ( response.notification );\n                    }// response.notification\n                }\n\t\t\t},\n\t\t\terror: aaAjaxError,\n\t\t});\n\t\treturn false;\n\t});\n\n}\n\n\n\n});\n"],"sourceRoot":"/source/"}